<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Korea Fire Detection Map</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        #googleMap {
            width: 100%;
            height: 100vh;
        }
    </style>
</head>
<body>
    <div id="googleMap"></div>

    <script>
    function myMap(){
        var mapOptions = { 
            center: new google.maps.LatLng(36.5, 127.5),
            zoom: 7
        };
    
        var map = new google.maps.Map( 
            document.getElementById("googleMap"), 
            mapOptions 
        );

        // Django APIì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        fetch('/api/fire-data/')
            .then(response => response.json())
            .then(data => {
                console.log('ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', data.length + 'ê°œ');
                
                data.forEach(function(fire) {
                    // ë§ˆì»¤ ìƒì„±
                    var marker = new google.maps.Marker({
                        position: new google.maps.LatLng(fire.latitude, fire.longitude),
                        map: map,
                        icon: {
                            path: google.maps.SymbolPath.CIRCLE,
                            fillColor: fire.frp > 5 ? '#FF0000' : '#FF6600',
                            fillOpacity: 0.8,
                            strokeColor: '#8B0000',
                            strokeWeight: 2,
                            scale: Math.max(5, fire.frp * 2)
                        }
                    });

                    // ì •ë³´ì°½
                    var infowindow = new google.maps.InfoWindow({
                        content: `
                            <div style="padding: 10px; font-family: Arial;">
                                <h3 style="margin: 0 0 10px 0; color: #d32f2f;">ğŸ”¥ í™”ì¬ ê°ì§€</h3>
                                <p style="margin: 5px 0;"><strong>ìœ„ì¹˜:</strong> ${fire.latitude.toFixed(4)}, ${fire.longitude.toFixed(4)}</p>
                                <p style="margin: 5px 0;"><strong>FRP:</strong> ${fire.frp} MW</p>
                                <p style="margin: 5px 0;"><strong>ì˜¨ë„:</strong> ${fire.bright_ti4}K</p>
                                <p style="margin: 5px 0;"><strong>ë‚ ì§œ:</strong> ${fire.acq_date}</p>
                                <p style="margin: 5px 0;"><strong>ì‹œê°„:</strong> ${fire.acq_time}</p>
                                <p style="margin: 5px 0;"><strong>ìœ„ì„±:</strong> ${fire.satellite}</p>
                                <p style="margin: 5px 0;"><strong>ì‹ ë¢°ë„:</strong> ${fire.confidence}</p>
                            </div>
                        `
                    });

                    // ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸
                    marker.addListener('click', function() {
                        infowindow.open(map, marker);
                    });
                });
            })
            .catch(error => {
                console.error('Error loading fire data:', error);
                alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            });
    }
    </script> 
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDMgR74mjlB4MutK1-jqO8gthz-T45jtXg&callback=myMap"></script>
</body>
</html>