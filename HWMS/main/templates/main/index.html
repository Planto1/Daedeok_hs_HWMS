<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Korea Fire Detection Map</title>
</head>
<body>
    <div id="googleMap" style="width: 100%;height: 700px;"></div>

    <script>
    function myMap(){
        var mapOptions = { 
            center: new google.maps.LatLng(36.5, 127.5),
            zoom: 7
        };
    
        var map = new google.maps.Map( 
            document.getElementById("googleMap"), 
            mapOptions 
        );

        // Django에서 데이터 가져오기
        fetch('/api/fire-data/')  // 이 URL은 views.py에서 만들어야 함
            .then(response => response.json())
            .then(data => {
                data.forEach(function(fire) {
                    // 마커 생성
                    var marker = new google.maps.Marker({
                        position: new google.maps.LatLng(fire.latitude, fire.longitude),
                        map: map,
                        icon: {
                            path: google.maps.SymbolPath.CIRCLE,
                            fillColor: '#FF0000',
                            fillOpacity: 0.7,
                            strokeColor: '#8B0000',
                            strokeWeight: 2,
                            scale: fire.frp * 2  // FRP 값에 따라 크기 조절
                        }
                    });

                    // 정보창
                    var infowindow = new google.maps.InfoWindow({
                        content: `
                            <div style="padding: 10px;">
                                <strong>화재 감지</strong><br>
                                위치: ${fire.latitude}, ${fire.longitude}<br>
                                FRP: ${fire.frp} MW<br>
                                온도: ${fire.bright_ti4}K<br>
                                날짜: ${fire.acq_date}<br>
                                시간: ${fire.acq_time}<br>
                                위성: ${fire.satellite}
                            </div>
                        `
                    });

                    // 마커 클릭 이벤트
                    marker.addListener('click', function() {
                        infowindow.open(map, marker);
                    });
                });
            })
            .catch(error => console.error('Error:', error));
    }
    </script> 
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDMgR74mjlB4MutK1-jqO8gthz-T45jtXg&callback=myMap"></script>
</body>
</html>